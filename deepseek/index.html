<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepSeek V3/R1 Architecture Explorer</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="tech-grid-background"></div>
    
    <header class="main-header">
        <div class="header-content">
            <div class="logo-section">
                <div class="logo-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <rect width="32" height="32" rx="6" fill="url(#gradient1)"/>
                        <path d="M8 12L16 8L24 12L16 16L8 12Z" fill="white" opacity="0.9"/>
                        <path d="M8 20L16 16L24 20L16 24L8 20Z" fill="white" opacity="0.7"/>
                        <defs>
                            <linearGradient id="gradient1" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#4ECDC4"/>
                                <stop offset="100%" style="stop-color:#00CED1"/>
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <div class="header-text">
                    <h1>DeepSeek V3/R1 Architecture Explorer</h1>
                    <p class="subtitle">Interactive demonstration of Multi-Head Latent Attention (MLA) and Mixture of Experts (MoE)</p>
                </div>
            </div>
            
            <div class="header-stats">
                <div class="stat-item">
                    <span class="stat-label">Total Params</span>
                    <span class="stat-value">671B</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Active</span>
                    <span class="stat-value">37B</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Efficiency</span>
                    <span class="stat-value">94.5%</span>
                </div>
            </div>
        </div>
    </header>

    <nav class="control-panel">
        <div class="controls-container">
            <div class="input-section">
                <div class="input-group">
                    <label for="token-input" class="input-label">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M3 2v4.586l7 7L14.586 9l-7-7H3zM2 2a1 1 0 0 1 1-1h4.586a1 1 0 0 1 .707.293l7 7a1 1 0 0 1 0 1.414L11.586 14a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 2 6.586V2z"/>
                            <path d="M5.5 5a.5.5 0 1 1 0-1 .5.5 0 0 1 0 1zm0 1a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3zM1 7.086a1 1 0 0 0 .293.707L8.75 15.25l-.043.043a1 1 0 0 1-1.414 0l-7-7A1 1 0 0 1 0 7.586V3a1 1 0 0 1 1-1v5.086z"/>
                        </svg>
                        Input Text
                    </label>
                    <div class="input-wrapper">
                        <input type="text" id="token-input" placeholder="Enter text to process through DeepSeek architecture..." value="The quick brown fox jumps over the lazy dog">
                        <button id="process-btn" class="process-button">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="m11.596 8.697-6.363 3.692c-.54.313-1.233-.066-1.233-.697V4.308c0-.63.692-1.01 1.233-.696l6.363 3.692a.802.802 0 0 1 0 1.393z"/>
                            </svg>
                            Process
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="parameters-section">
                <div class="param-group">
                    <label for="compression-slider" class="param-label">
                        <span class="label-text">MLA Compression Ratio</span>
                        <span class="param-value" id="compression-value">4x</span>
                    </label>
                    <div class="slider-container">
                        <input type="range" id="compression-slider" min="2" max="8" value="4" class="param-slider">
                        <div class="slider-track"></div>
                    </div>
                </div>
                
                <div class="param-group">
                    <label for="expert-count" class="param-label">
                        <span class="label-text">Visible Experts</span>
                    </label>
                    <div class="select-wrapper">
                        <select id="expert-count" class="param-select">
                            <option value="16">16 Experts</option>
                            <option value="24">24 Experts</option>
                            <option value="32" selected>32 Experts</option>
                        </select>
                        <svg class="select-arrow" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
                        </svg>
                    </div>
                </div>
                
                <div class="param-group">
                    <label class="param-label">
                        <span class="label-text">Animation Speed</span>
                        <span class="param-value">1.0x</span>
                    </label>
                    <div class="slider-container">
                        <input type="range" id="speed-slider" min="0.5" max="2" step="0.1" value="1" class="param-slider">
                        <div class="slider-track"></div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="reset-btn" class="action-button secondary">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
                        <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
                    </svg>
                    Reset
                </button>
                <button id="export-btn" class="action-button secondary">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                    </svg>
                    Export
                </button>
            </div>
        </div>
    </nav>

    <main class="app-container">
        <!-- Architecture Comparison Section -->
        <section class="architecture-section comparison-section">
            <div class="section-header">
                <div class="section-title">
                    <div class="title-icon comparison-icon"></div>
                    <div class="title-content">
                        <h2>Attention Architecture Comparison</h2>
                        <p class="section-description">DeepSeek MLA vs Traditional Attention Mechanisms</p>
                    </div>
                </div>
                <div class="section-controls">
                    <div class="architecture-selector">
                        <label for="comparison-arch">Compare with:</label>
                        <div class="select-wrapper">
                            <select id="comparison-arch" class="param-select">
                                <option value="gqa" selected>Grouped Query Attention (GQA)</option>
                                <option value="mqa">Multi-Query Attention (MQA)</option>
                                <option value="mha">Multi-Head Attention (MHA)</option>
                            </select>
                            <svg class="select-arrow" width="12" height="12" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
                            </svg>
                        </div>
                    </div>
                    <div class="toggle-switch">
                        <input type="checkbox" id="comparison-details" checked>
                        <label for="comparison-details">Show Details</label>
                    </div>
                </div>
            </div>
            
            <div class="comparison-container">
                <div class="architecture-panel mla-panel">
                    <div class="panel-header">
                        <h3>DeepSeek MLA</h3>
                        <div class="architecture-badge mla">DeepSeek V3</div>
                    </div>
                    <div class="visualization-container">
                        <canvas id="mla-canvas" width="1200" height="400"></canvas>
                        <div class="visualization-overlay">
                            <div class="processing-indicator" id="mla-indicator">
                                <div class="indicator-dot"></div>
                                <span>Processing tokens...</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="architecture-panel comparison-panel">
                    <div class="panel-header">
                        <h3 id="comparison-title">Grouped Query Attention</h3>
                        <div class="architecture-badge comparison" id="comparison-badge">Traditional</div>
                    </div>
                    <div class="visualization-container">
                        <canvas id="comparison-canvas" width="1200" height="400"></canvas>
                        <div class="visualization-overlay">
                            <div class="processing-indicator" id="comparison-indicator">
                                <div class="indicator-dot"></div>
                                <span>Processing tokens...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Analytics Section -->
        <!-- <section class="architecture-section analytics-section">
            <div class="section-header">
                <div class="section-title">
                    <div class="title-icon analytics-icon"></div>
                    <div class="title-content">
                        <h2>Performance Analytics</h2>
                        <p class="section-description">Comparative metrics and efficiency analysis</p>
                    </div>
                </div>
            </div>
            
            <div class="analytics-container">
                <div class="analytics-grid">
                    <div class="analytics-panel memory-panel">
                        <h4>Memory Usage Comparison</h4>
                        <canvas id="memory-chart" width="400" height="200"></canvas>
                        <div class="chart-legend">
                            <div class="legend-item mla"><span class="legend-dot"></span>DeepSeek MLA</div>
                            <div class="legend-item comparison"><span class="legend-dot"></span><span id="comparison-legend">GQA</span></div>
                        </div>
                    </div>
                    
                    <div class="analytics-panel performance-panel">
                        <h4>Performance Metrics</h4>
                        <canvas id="performance-chart" width="400" height="200"></canvas>
                        <div class="performance-stats">
                            <div class="stat-row">
                                <span class="stat-label">Inference Speed:</span>
                                <span class="stat-value" id="speed-comparison">2.3x faster</span>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">Memory Efficiency:</span>
                                <span class="stat-value" id="memory-efficiency">75% reduction</span>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">Quality Score:</span>
                                <span class="stat-value" id="quality-score">98.5% maintained</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="analytics-panel summary-panel">
                        <h4>Architecture Summary</h4>
                        <div class="summary-grid">
                            <div class="summary-item mla-summary">
                                <h5>DeepSeek MLA</h5>
                                <ul class="feature-list">
                                    <li>4x KV cache compression</li>
                                    <li>Latent space mapping</li>
                                    <li>Superior long sequences</li>
                                    <li>Maintains quality</li>
                                </ul>
                            </div>
                            <div class="summary-item comparison-summary">
                                <h5 id="comparison-summary-title">GQA</h5>
                                <ul class="feature-list" id="comparison-features">
                                    <li>Grouped key-value heads</li>
                                    <li>Moderate memory savings</li>
                                    <li>Simple implementation</li>
                                    <li>Balanced trade-offs</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section> -->

        <!-- Integration Arrow -->
        <div class="integration-arrow">
            <div class="arrow-line"></div>
            <div class="arrow-head"></div>
            <div class="integration-label">Sequential Processing</div>
        </div>

        <!-- MoE Section -->
        <section class="architecture-section moe-section">
            <div class="section-header">
                <div class="section-title">
                    <div class="title-icon moe-icon"></div>
                    <div class="title-content">
                        <h2>Mixture of Experts (MoE)</h2>
                        <p class="section-description">Sparse activation with shared expert architecture</p>
                    </div>
                </div>
                <div class="section-controls">
                    <div class="toggle-switch">
                        <input type="checkbox" id="moe-details" checked>
                        <label for="moe-details">Show Connections</label>
                    </div>
                </div>
            </div>
            
            <div class="visualization-container">
                <canvas id="moe-canvas" width="1200" height="600"></canvas>
                <div class="visualization-overlay">
                    <div class="processing-indicator" id="moe-indicator">
                        <div class="indicator-dot"></div>
                        <span>Routing experts...</span>
                    </div>
                </div>
            </div>
            
            <div class="metrics-panel">
                <div class="metric-card primary">
                    <div class="metric-header">
                        <span class="metric-label">Active Parameters</span>
                        <div class="metric-trend up">↑ 94.5%</div>
                    </div>
                    <div class="metric-value" id="active-params">37B / 671B</div>
                    <div class="metric-subtitle">Sparse Activation</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-label">Expert Selection</span>
                    </div>
                    <div class="metric-value" id="selected-experts">9 Total</div>
                    <div class="metric-subtitle">1 Shared + 8 Routed</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-label">Router Efficiency</span>
                    </div>
                    <div class="metric-value">Load Balanced</div>
                    <div class="metric-subtitle">No Auxiliary Loss</div>
                </div>
                
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-label">Total Experts</span>
                    </div>
                    <div class="metric-value">256 → 32</div>
                    <div class="metric-subtitle">Visualization Scale</div>
                </div>
            </div>
        </section>
    </main>

    <footer class="app-footer">
        <div class="footer-content">
            <div class="footer-info">
                <p>DeepSeek V3/R1 Architecture Explorer - Educational Visualization</p>
                <p class="footer-note">Based on Sebastian Raschka's analysis and DeepSeek's technical architecture</p>
            </div>
            <div class="footer-links">
                <a href="#" class="footer-link">Documentation</a>
                <a href="#" class="footer-link">Source Code</a>
                <a href="#" class="footer-link">About</a>
            </div>
        </div>
    </footer>

    <script src="js/mla.js"></script>
    <script src="js/moe.js"></script>
    <script src="js/comparison.js"></script>
    <script src="js/analytics.js"></script>
    <script src="js/main.js"></script>
</body>
</html>